<!DOCTYPE html>
<html lang="en">

<head>
    <title>Gui B.L Software Engineering-Code and posts about tech and programming</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Gui B.L coder and entrepreneur-free tutorials with sample code and topics about tech and programming">
    <meta name="author" content="Guilherme Becker Lamounier">

    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css">

    <!-- Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='/font-awesome/css/font-lora.css' rel='stylesheet' type='text/css'>
    <link href='/font-awesome/css/font-montserrat.css' rel='stylesheet' type='text/css'>

    <!-- Custom Theme CSS -->
    <link href="/css/grayscale.css" rel="stylesheet">

    <!-- Syntax highlight CSS -->
    <link href="/css/syntax.css" rel="stylesheet" type="text/css">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-49522383-1', 'guilhebl.github.io');
  ga('send', 'pageview');
</script>

</head>

<body id="page-top" data-spy="scroll" data-target=".navbar-custom">

    <nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
                    <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="/index.html">
                    <i class="fa fa-play-circle"></i>  <span class="light">guilhebl</span>
                </a>
            </div>

	<div class="col-sm-3 col-md-3 pull-right">
        <div class="input-group">

            <input type="text" class="search-field form-control" placeholder="Search" autocomplete="off">
            <div class="input-group-btn">
                <button class="btn btn-default" type="button"><i class="glyphicon glyphicon-search"></i></button>
            </div>
        </div>
        </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-right navbar-main-collapse">

                <ul class="nav navbar-nav">
                    <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li class="page-scroll">
                        <a href="/#postList"><i class="fa fa-home fa-fw marginRight6"></i>Home</a>
                    </li>
                    <li class="page-scroll">
                        <a href="/categories"><i class="fa fa-list-ul fa-fw marginRight6"></i>Pages</a>
                    </li>
                    <li class="page-scroll">
                        <a href="/about"><i class="fa fa-user fa-fw marginRight6"></i>About</a>
                    </li>
                    <li class="page-scroll">
                        <a href="/contact"><i class="fa fa-coffee fa-fw marginRight6"></i>Contact</a>
                    </li>
                </ul>

            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->

        <div class="results resultsBox"></div>
    </nav>


    <section class="post">
        <div class="post-body">
            <div class="container">
		<div class="row-fluid">
		  <div class="center-block">
		     <section class="paper">
		      	<article class="head">Java Test - code coverage using Jacoco</article>
			<p class="muted">05 February 2017</p>

			<article contenteditable="false"><hr />

<h2>Java code coverage</h2>

<p>In Java there are a wide variety of code coverage tools out there. One of the most popular is jacoco which provides an easy setup if you're using maven or gradle.
This post will be showing how to setup a java project in maven using jacoco code coverage.</p>

<hr />

<h3>1. Maven dependency</h3>

<p>Insert maven dependency for jacoco in your maven project:</p>

<p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.jacoco<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>jacoco-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>0.7.8<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span></code></pre></figure></p>

<h3>2. Maven plugin</h3>

<p>Insert maven plugin for jacoco in your maven project:</p>

<p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;build&gt;</span>
  <span class="nt">&lt;plugins&gt;</span>
     <span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${org.apache.maven.plugins.maven.maven-compiler-plugin.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;configuration&gt;</span>
      <span class="nt">&lt;source&gt;</span>1.8<span class="nt">&lt;/source&gt;</span>
      <span class="nt">&lt;target&gt;</span>1.8<span class="nt">&lt;/target&gt;</span>
    <span class="nt">&lt;/configuration&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span> <br/>
      <span class="nt">&lt;plugin&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.jacoco<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>jacoco-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>0.7.8<span class="nt">&lt;/version&gt;</span>
      <span class="nt">&lt;executions&gt;</span>
        <span class="nt">&lt;execution&gt;</span>
        <span class="nt">&lt;id&gt;</span>default-prepare-agent<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;goals&gt;</span>
          <span class="nt">&lt;goal&gt;</span>prepare-agent<span class="nt">&lt;/goal&gt;</span>
        <span class="nt">&lt;/goals&gt;</span>
        <span class="nt">&lt;/execution&gt;</span>
            <span class="nt">&lt;execution&gt;</span>
        <span class="nt">&lt;id&gt;</span>default-report<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;phase&gt;</span>prepare-package<span class="nt">&lt;/phase&gt;</span>
        <span class="nt">&lt;goals&gt;</span>
          <span class="nt">&lt;goal&gt;</span>report<span class="nt">&lt;/goal&gt;</span>
        <span class="nt">&lt;/goals&gt;</span>
        <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;execution&gt;</span>
        <span class="nt">&lt;id&gt;</span>default-check<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;goals&gt;</span>
          <span class="nt">&lt;goal&gt;</span>check<span class="nt">&lt;/goal&gt;</span>
        <span class="nt">&lt;/goals&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
               <span class="nt">&lt;rules&gt;</span>
             <span class="c">&lt;!-- implementation is needed only for Maven 2 --&gt;</span>
             <span class="nt">&lt;rule</span> <span class="na">implementation=</span><span class="s">"org.jacoco.maven.RuleConfiguration"</span><span class="nt">&gt;</span>
               <span class="nt">&lt;element&gt;</span>BUNDLE<span class="nt">&lt;/element&gt;</span>
               <span class="nt">&lt;limits&gt;</span>
                 <span class="c">&lt;!-- define your test coverage treshold % for accepting the build --&gt;</span>
                 <span class="nt">&lt;limit</span> <span class="na">implementation=</span><span class="s">"org.jacoco.report.check.Limit"</span><span class="nt">&gt;</span>
                   <span class="nt">&lt;counter&gt;</span>COMPLEXITY<span class="nt">&lt;/counter&gt;</span>
                   <span class="nt">&lt;value&gt;</span>COVEREDRATIO<span class="nt">&lt;/value&gt;</span>
                   <span class="nt">&lt;minimum&gt;</span>0.99<span class="nt">&lt;/minimum&gt;</span>
                 <span class="nt">&lt;/limit&gt;</span>
               <span class="nt">&lt;/limits&gt;</span>
             <span class="nt">&lt;/rule&gt;</span>
           <span class="nt">&lt;/rules&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;/execution&gt;</span>
      <span class="nt">&lt;/executions&gt;</span>
    <span class="nt">&lt;/plugin&gt;</span>
   <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span></code></pre></figure></p>

<h3>3. Sample Unit test</h3>

<p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">sample</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">coverage</span><span class="o">;</span></p>

<p><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">User</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">name</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">""</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">name</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="o">);</span>
    <span class="o">}</span>  <br/>
<span class="o">}</span></code></pre></figure></p>

<p>Unit test:</p>

<p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">sample</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">coverage</span><span class="o">;</span></p>

<p><span class="kn">import</span> <span class="nn">org.junit.Assert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span></p>

<p><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserTest</span> <span class="o">{</span>
    <span class="cm">/<strong>
     * Tests set and get
     */</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUserGettersAndSetters</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">"joe"</span><span class="o">);</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">""</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">==</span> <span class="kc">null</span><span class="o">);</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"java"</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"java"</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUserIsValid</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">"joe smith"</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">isValid</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="cm">/</strong>
     * Tests user name null
     <em>/</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUserNameNull</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(!</span><span class="n">user</span><span class="o">.</span><span class="na">isValid</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="cm">/**
     * Tests user name empty
     </em>/</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUserNameEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(!</span><span class="n">user</span><span class="o">.</span><span class="na">isValid</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="cm">/<em>*
     * Tests user name too Long
     </em>/</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUserInavlidNameTooLong</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">"joe the world wide clock field service man"</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(!</span><span class="n">user</span><span class="o">.</span><span class="na">isValid</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure></p>

<hr />

<h3>4. Run maven build and see test coverage report</h3>

<p>run mvn clean install or mvn test to trigger the unit test execution.
Once tests are finished check file {PROJECT_FOLDER}/target/site/jacoco/index.html for coverage report (open in any browser):</p>

<p><img src="/assets/img/test-coverage-001.png" alt="TEXT screenshot" /></p>

<hr />

<h3>5. Links</h3>

<p><a href="https://en.wikipedia.org/wiki/Code_coverage">Code coverage</a></p>

<hr />
</article>
		      </section>

		    <div id="disqus_thread"></div>
		    <script type="text/javascript">
			/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			var disqus_shortname = 'guilhebliopages'; // required: replace example with your forum shortname

			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
			    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		    </script>
		    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>		    
		  </div>

		</div>
            </div>
        </div>
    </section>
    <!-- Core JavaScript Files -->
    <script src="/js/jquery-1.10.2.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/jquery.easing.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/js/grayscale.js"></script>

    <!-- Plugin Third party JavaScript -->
    <script src="/js/jekyll-search.js"></script>
    <script src="/js/jekyll-search.jquery.js"></script>
 
</body>

</html>


